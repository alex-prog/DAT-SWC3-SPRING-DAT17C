<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Survey Form</title>
    <link rel="stylesheet" href="css/bootstrap.css"/>
    <script src="js/bootstrap.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"/>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
            integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
            crossorigin="anonymous"></script>
</head>
<body style="background-color: #eeeeee">
<br/>
<div class="col-md-2"></div>
<div class="container col-md-8" style="background-color: white; border-radius: 5px;">
    <h1 id="title" class="text-center">Save Car Form</h1>
    <p class="text-center" id="description">Ho-ho-ho! treasure of madness.</p>
    <hr/>
    <div class="form-group row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <label for="brand" id="name-label" class="col-form-label">Brand:</label>
            <input id="brand" type="text" class="form-control" placeholder="Brand" th:field="${car.brand}"/>
            <input id="car-id" type="text" class="form-control" hidden="hidden" th:field="${car.id}"/>
        </div>
        <div class="col-md-2"></div>
    </div>
    <div class="form-group row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <label for="colour" id="email-label" class="col-form-label">Colour:</label>
            <input name="colour" id="colour" type="text" class="form-control" placeholder="Colour"
                   th:field="${car.colour}"/>
        </div>
        <div class="col-md-2"></div>
    </div>
    <div class="form-group row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <label for="seats" id="number-label" class="col-form-label">Seats:</label>
            <input name="seats" id="seats" type="number" class="form-control" placeholder="Seats" min="1" max="999"
                   th:field="${car.seats}"/>
        </div>
        <div class="col-md-2"></div>
    </div>
    <div class="form-group row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <label for="speed" id="speed-label" class="col-form-label">Speed:</label>
            <input name="speed" id="speed" type="number" class="form-control" placeholder="Speed" min="1" max="9999"
                   th:field="${car.speed}"/>
        </div>
        <div class="col-md-2"></div>
    </div>
    <div class="form-group row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div class="form-group">
                <label for="select">Select user:</label>
                <select class="form-control" id="select-user" required="required" name="selected-user-id">
                    <option class="dropdown-item" th:each="user : ${users}"
                            th:text="${user.getName()}" th:value="${user.id}" th:selected="${user.id == car.user.id}">
                    </option>
                </select>
            </div>
        </div>
        <div class="col-md-2"></div>
    </div>
    <div class="form-group row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <button th:onclick=" 'javascript: updateCar(' + ${car.id} + ')'" class="btn btn-block btn-success">Update
            </button>
        </div>
        <div class="col-md-2"></div>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    function updateCar(id) {
        $.ajax({
            method: "PUT",
            url: "/car/update/" + id,
            data: {
                id: $("#car-id").val(),
                brand: $("#brand").val(),
                colour: $("#colour").val(),
                seats: $("#seats").val(),
                speed: $("#speed").val(),
                user: $("#select-user").val()
            },
            success: function () {
                window.location.href = "/cars";
            },
            error: function (error) {
                console.log(error)
            }
        })
    }
</script>
</body>
</html>